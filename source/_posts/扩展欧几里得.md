---
title: 扩展欧几里得
comments: true
data: 2018-03-09 15:08:38
categories:
- ACM
- 数学
- 数论
---

# 扩展欧几里得算法

在方程 a\*x + b\*y = M 中 M = m\*d

方程的通解为

X = m\*x + k\*b/a

Y = m\*y - k\*a/d

---
47x - 30y = 1与47x + 30y = 1之间有没有差别呢？

其实是没有的，实际手算过程是是不考虑负号的，最后结束的时候才会考虑。所以在
传递参数的时候只要传递47和30即可，然后再去直接改变x和y的符号.

<!--more-->

手算模拟：

47 = 30*1 + 17

30 = 17*1 + 13

17 = 13*1 + 4

4 = 4*1

---
17 = 47 - 30*1

13 = 30 - 17*1

4 = 17 - 13*1

1 = 13 - 4*3

---
1 = 13 - (17 - 13*1)*3

  = 47*(-7) + 30*11

---
x = -7     y = 11

## 模板
```cpp
ll ex_gcd(ll a,ll b,ll &x,ll &y){
    if((b == 0) && (a == 0)) return -1; //无最大公因数
    if(b == 0){
        x = 1;
        y = 0;
        return a;
    }
    else{
        ll d = ex_gcd(b,a%b,x,y);
        ll temp = x;
        x = y;
        y = temp = (a/b)*y;
        return d;
    }
}

int main(){
    ll a = 47,b=30;
    ll x,y;
    ll d = ex_gcd(a,b,x,y);     //47*x + 30*y = 1
    x = (x % (b/d) + b/d) % (b/d)       //取最大非负整数
    y = (1 - a*x) / b;
}
```
